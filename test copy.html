<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FLIP 动画方案</title>

  <style>
    #container {
      display: flex;
      gap: 10px;
    }

    #btn {
      background: rgb(26, 126, 26);
      width: 100px;
      height: 40px;
      border-radius: 10px;
      border: none;
      margin-block-end: 10px;
      cursor: pointer;
    }

    #container .item {
      width: 150px;
      height: 150px;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 1px solid #ccc;
      border-radius: 10px;
      font-size: 25px;
    }
  </style>
</head>

<body>

  <div id="container">
    <div class="item">1</div>
    <div class="item">2</div>
    <div class="item">3</div>
    <div class="item">4</div>
    <div class="item">5</div>
  </div>
  <button id="btn">随机排序</button>

  <script>
    const container = document.getElementById('container')
    const btn = document.getElementById('btn')

    // 记录开始位置信息
    function record() {
      const list = [...container.children]
      list.forEach((item, i) => {
        const rect = item.getBoundingClientRect()
        item.startX = rect.left
      })
    }

    function change() {
      const list = [...container.children]
      const len = list.length
      list.forEach((item, i) => {
        const newIndex = Math.floor(Math.random() * len)
        if (newIndex !== i) {
          const nextDOM = item.nextElementSibling
          container.insertBefore(item, list[newIndex])
          container.insertBefore(list[newIndex], nextDOM)
        }
      })
    }

    function play() {
      const list = [...container.children]
      const len = list.length
      list.forEach((item, i) => {
        const endPosition = item.getBoundingClientRect()
        const disX = item.startX - endPosition.left;
        item.animate([
          { transform: `translateX(${disX}px)` },
          { transform: 'translateX(0px)' }
        ], { duration: 500 })
      })
    }

    btn.onclick = () => {
      record()
      change()
      play()
    }

  </script>
</body>

</html>